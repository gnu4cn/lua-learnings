# 线程与状态

Lua 不支持真正的多线程，即抢占式的线程共享内存。缺乏支持有两个原因。第一个是 ISO C 并不支持多线程，因此 Lua 没有实现这种机制的可移植方法。第二个也是更重要的原因是，我们（Lua 开发团队）不认为多线程对于 Lua 来说是个好主意。


多线程是为底层编程开发的。像信号量及监视器这样的同步机制，synchronization mechanisms like semaphores and monitors，是在操作系统（与经验丰富的程序员），而非应用程序的背景下提出的。发现和纠正与多线程相关的 bug 非常困难，其中一些 bug 可能会导致安全漏洞。此外，多线程会导致与程序的某些关键部分，如内存分配器，需要同步相关的性能下降。


抢占与共享内存二者结合，会造成更多的多线程问题，因此通过使用非抢占线程，或不共享内存，我们可以避免这些问题。Lua 提供了这两种支持。Lua 的线程（也称为协程）是协作式的，因此可避免不可预知线程切换所带来的问题。Lua 状态不共享内存，而因此为 Lua 的并行机制，奠定了良好基础。我们将在本章中介绍这两种选项。


## 多线程



