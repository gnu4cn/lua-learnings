# 管理资源

在上一章中的布尔数组实现里，我们无需担心资源管理问题。这些数组只需要内存。表示某个数组的每个用户数据，都有其自己的内存，由 Lua 管理。当某个数组成为垃圾（即无法由程序访问到）时，Lua 最终会将其回收，并释放其内存。


生活并不总是那么简单。有时，除了原始内存，对象还需要其他资源，如文件描述符、窗口句柄等。(这些资源通常也只是内存，但由系统的其他部分管理。）在这种情况下，当对象成为垃圾并被回收时，这些别的资源也必须以某种方式释放。


正如我们在 [“终结器”](./garbage.md#终结器) 小节中所看到的，Lua 以 `__gc` 元方法的形式，提供了终结器。为了说明在 C 中，以及这个 API 作为整体下，这个元方法的用法，我们将在本章中，开发两项外部设施的 Lua 绑定。第一个示例，是一个遍历目录函数的另一种实现。第二个（也是更重要的）示例，是对一种开源 XML 解析器，[`Expat`](https://libexpat.github.io/) 的绑定。


## 一个目录迭代器
